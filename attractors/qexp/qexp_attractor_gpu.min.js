let QubicExpGPU=class{constructor(i,t){this.Rate=.02,this.PMin=[-1.2,-1.2,.2,.2],this.PMax=[1.2,1.2,1.2,1.2];this.XMin=[-3,-3],this.XMax=[3,3],this.XDim=2,this.PDim=4,this.NP=i,this.Kick=null==t?.01:t,this.Points=[];t=new GPU;function e(t){return(1-3.5*t*t)/Math.cosh(2*t)}function o(t){return 2.3*t/Math.cosh(2*t)}t.addFunction(function(t){return 3*(t*t*t-1.2*t)/Math.cosh(2*t)}),t.addFunction(e),t.addFunction(o),this.qexp_kernel=t.createKernel(function(t,i){var n=i[0],s=i[1],r=i[2],i=i[3],h=t[this.thread.x][0],t=t[this.thread.x][1];return[e(n*h)+o(s*t),e(r*t)+o(i*h)]},{output:[this.NP]}),this.normal=function(){return Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()+Math.random()-6},this.random_point=function(){return[this.normal(),this.normal()]},this.Points=[];for(let t=0;t<i;t++)this.Points.push(this.random_point())}step(t){if(0<this.Kick)for(let t=0;t<this.Points.length;t++)Math.random()<this.Kick&&(this.Points[t]=this.random_point());return this.Points=this.qexp_kernel(this.Points,t),this.Points}},SingleQExpGPU=class{constructor(t){this.NP=5e4,this.D=new QubicExpGPU(this.NP,.03),this.margin=0;var i=window.innerWidth,n=window.innerHeight,s=this.D.XMin,r=this.D.XMax;this.C=new Canvas(t,i,n,s[0],s[1],r[0],r[1]),this.ClearColor=[0,0,0];const h=this;window.onresize=function(){h.resize()},this.C.clear(this.ClearColor,1),this.PMorpher=new Morpher(this.D.PMin,this.D.PMax);this.DT=.01,this.Colors=new ColorChanger;for(var e=this.PMorpher.step(this.DT),o=0;o<10;o++)this.D.step(e)}resize(){var t=window.innerWidth,i=window.innerHeight;this.C.resize(t-2*this.margin,i-2*this.margin)}step(){var t=this.Colors.next_color(),i=this.PMorpher.step(this.DT),i=this.D.step(i);this.C.clear(this.ClearColor,.2),this.C.points(i,t,.2),this.C.render()}animate_one_frame(){const t=this;this.step(),window.requestAnimationFrame(function(){t.animate_one_frame()})}start(){const t=this;window.requestAnimationFrame(function(){t.animate_one_frame()})}},DuelingQExpGPU=class{constructor(t){this.D1=new QubicExpGPU(4e4,.03),this.D2=new QubicExpGPU(4e4,.03),this.margin=0;var i=window.innerWidth,n=window.innerHeight,s=this.D1.XMin,r=this.D1.XMax;this.C=new Canvas(t,i,n,s[0],s[1],r[0],r[1]),this.ClearColor=[0,0,0],this.DT=.02,this.window_resized=function(t){var i=window.innerWidth,n=window.innerHeight;this.C.resize(i-2*margin,n-2*margin)};const h=this;window.onresize=function(){h.resize()},this.C.clear(this.ClearColor,1),this.M1=new Morpher(this.D1.PMin,this.D1.PMax),this.M2=new Morpher(this.D2.PMin,this.D2.PMax),this.params12=function(t,i,n,s){var r=i.step(t),h=n.step(t),e=[];for(let t=0;t<r.length;t++)e.push(r[t]*s+h[t]*(1-s));return[e,h]},this.SBM=new Morpher([.2,.1],[.8,.2]);for(var t=this.SBM.step(.03),i=(this.Colors1=new ColorChanger,this.Colors2=new ColorChanger,this.params12(this.DT,this.M1,this.M2,t[1])),e=i[0],o=i[1],a=0;a<30;a++)this.D1.step(e),this.D2.step(o)}step(){var i=this.Colors1.next_color(),n=this.Colors2.next_color();for(let t=0;t<3;t++)n[t]=(n[t]+i[t])/2;var s,t=this.SBM.step(.03),r=t[0],t=t[1],t=this.params12(this.DT,this.M1,this.M2,t),h=t[0],t=t[1],e=this.D1.step(h),o=this.D2.step(t);this.C.clear(this.ClearColor,.2),this.C.points(e,i,.2*r),this.C.points(o,n,.2*(1-r));for(let t=0;t<e.length;t++)Math.random()<.01&&(s=e[t],e[t]=o[t],o[t]=s);this.C.render()}animate_one_frame(){const t=this;this.step(),window.requestAnimationFrame(function(){t.animate_one_frame()})}start(){const t=this;window.requestAnimationFrame(function(){t.animate_one_frame()})}resize(){var t=window.innerWidth,i=window.innerHeight;this.C.resize(t-2*this.margin,i-2*this.margin)}};
