<html>

<head>
    
    <style type="text/css">

        body {
            padding: 50px;
        }
        
        body, th, td {
            font-family: arial;
            font-size: 16px;
        }
        
        .form th {
            text-align: right;
            color: #888;
        }
        
        .form th, .form td {
            padding: 5px;
        }
        
        #password {
            font-family: monospace;
            font-size: 16px;
        }
        
        sup {
            font-size: 10px;
        }
    </style>
    
</head>

<body>
    <script>
        
        function charset(options)
        {
            var chars = "";

            if( options.upper ) chars += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            if( options.lower ) chars += "abcdefghijklmnopqrstuvwxyz";
            if( options.digits ) chars += "0123456789";
            if( options.symbols ) chars += "!$%'()+,-./:;=?@^_|~\\";
            return chars;
        }
        
        function generate(options)
        {
            var chars = charset(options);
            var length = options.length;

            var array = new Uint32Array(length);
            window.crypto.getRandomValues(array);
            var password = "";
            for( var i=0; i < array.length; i++ )
                password += chars[array[i] % chars.length];
            
            return password
        }

        function read_options()
        {
            var options = {};
            var len_select = document.getElementById("length")
            options.length = parseInt(len_select.options[len_select.selectedIndex].value);
            options.upper = document.getElementById("upper").checked;
            options.lower = document.getElementById("lower").checked;
            options.digits = document.getElementById("digits").checked;
            options.symbols = document.getElementById("symbols").checked;
            return options;
        }

        function run()
        {
            var password = generate(read_options());
            document.getElementById("password").value = password;
        }

        function recalculate()
        {
            var options = read_options();
            var chars = charset(options);
            if( chars.length > 0 )
            {
                var log10n = options.length*Math.log(chars.length)/Math.log(10);
                document.getElementById("combinations").innerHTML = "10<sup>" + Math.floor(log10n) + "</sup>";
            }
            else
                document.getElementById("combinations").innerHTML = "0";
        }
        var clear_timer = null;
        
        function clear_copied()
        {
            document.getElementById("copied_text").innerHTML = "";
            clear_timer = null;
        }

        function copy_password()
        {
            var password_input = document.getElementById("password");
            password_input.select();
            password_input.setSelectionRange(0, 99999); /* For mobile devices */

             /* Copy the text inside the text field */
            navigator.clipboard.writeText(password_input.value);
            document.getElementById("copied_text").innerHTML = "copied to clipboard";
            if( clear_timer != null )
                window.clearTimeout(clear_timer);
            clear_timer = setTimeout(clear_copied, 2000);
        }
        

    </script>
        
    <h1>Random Password Generator</h1>
        
    <table class="form">
        <tr>
            <th>Length:</th>
            <td colspan=4>
                <select id="length" onchange="recalculate()">
                    <option value="" disabled="disabled">-- weak --</option>
                    <option value="8">8</option>
                    <option value="10">10</option>
                    <option value="12">12</option>
                    <option value="" disabled="disabled">-- strong --</option>
                    <option value="16" selected="selected">16</option>
                    <option value="18">18</option>
                    <option value="20">20</option>
                    <option value="" disabled="disabled">-- very strong --</option>
                    <option value="24">24</option>
                    <option value="32">32</option>
                    <option value="40">40</option>
                    <option value="50">50</option>
                </select>
            </td>
        </tr>
        <tr>
            <th>Include:</th>
            <td width=0px><input type="checkbox" checked="checked" id="upper" width="0px" onchange="recalculate()"/></td>
            <td>upper case letters</td>
            <td width=0px><input type="checkbox" checked="checked" id="lower" onchange="recalculate()"/></td>
            <td>lower case letters</td>
        </tr>
        <tr>
            <td></td>
            <td width=0px><input type="checkbox" checked="checked" id="digits" onchange="recalculate()"/></td><td>digits</td>
            <td width=0px><input type="checkbox" checked="checked" id="symbols" onchange="recalculate()"/></td><td>symbols</td>
        </tr>
        <tr>
            <th>Combinations:</th>
            <td id="combinations"></td>
            <td colspan=3 style="color:gray; font-size: 12px">age of the Universe: 3*10<sup>23</sup> microseconds</td>
            <td><button onclick="run()">generate password</button></td>
        </tr>
        <tr>
            <th>Password:</th>
            <td colspan=4><input type=text disabled="disabled" id="password" size=50/></td>
            <td><button onclick="copy_password()">copy password</button></td>
            <td id="copied_text"></td>
        </tr>
    </table>    
    
    <p style="color:gray; position: fixed; bottom:5px">
        Random password generator is only as good as the random number generator it uses to pick random characrets for the password. 
        Many popular random password generators available
        on the internet use basic pseudo-random number generator, which is known not to be good for cryptographic purposes. 
        Unlike many others, this password generator uses cryptographically strong random number generator and therefore 
        produces reliably random, hard to guess passwords.
    </p>
    
    <script>
        recalculate();
    </script>
</body>

</html>